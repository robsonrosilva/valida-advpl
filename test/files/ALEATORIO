	BeginSql Alias ccAlias
		SELECT
			ZZ2_TIPO,
			ZZ2_VALOR,
			ZZ5_FILIAL,
			A1_NOME,
			ZZ5_PROTOR,
			ZZ5_NMPROD,
			SUM(ZZ5_QTDVID) ZZ5_QTDVID,
			SUM(ZZ5_VALORM) ZZ5_VALORM
		FROM
			ZZ5010 ZZ5
		INNER JOIN SA1010 A1
		ON A1.R_E_C_N_O_ = (
				SELECT
					TOP 1 R_E_C_N_O_
				FROM
					SA1010
				WHERE
					D_E_L_E_T_ = ' '
					AND A1_CGC = ZZ5_CGCCLI
			)
		INNER JOIN ZZH010 ZZH
		ON ZZH.D_E_L_E_T_ = ' '
			AND ZZH_CLIENT = A1_COD
			AND ZZH_LOJA = A1_LOJA
			AND ZZ5_DTVIGE BETWEEN ZZH_DATAIN AND ZZH_DATAFI
			AND (
				ZZH_TPPROD = ZZ5_PRODUT
				OR ZZH_TPPROD = 'T'
			)
		INNER JOIN ZZ2010 ZZ2
		ON ZZ2.D_E_L_E_T_ = ' '
			AND ZZ2_CLIENT = ZZH_CLIENT
			AND ZZ2_LOJA = ZZH_LOJA
			AND ZZ2_CAMPAN = ZZH_CODIGO
		WHERE
			ZZ5.D_E_L_E_T_ = ' '
			AND ZZ5_DTVIGE BETWEEN %exp:MV_PAR01% AND %exp:MV_PAR02%
			AND ZZ5_CODIGO IN(
				SELECT
					C6_XNUMCTR
				FROM
					SC6010 C6
				INNER JOIN SD2010 D2
				ON D2.D_E_L_E_T_ = ''
					AND D2_PEDIDO = C6_NUM
					AND D2_ITEMPV = C6_ITEM
					AND D2_FILIAL = C6_FILIAL
					AND C6.D_E_L_E_T_ = ' '
			)
		GROUP BY
			ZZ2_TIPO,
			ZZ2_VALOR,
			ZZ5_FILIAL,
			A1_NOME,
			ZZ5_PROTOR,
			ZZ5_NMPROD,
			ZZ2_VIDAIN,
			ZZ2_VIDAFI,
			ZZ2_METAIN,
			ZZ2_METAFI,
			ZZ2_TIPO
		HAVING
			(
				//-- Campanha de Quantidade de Vidas
				(
					ZZ2_TIPO = 'Q'
					AND SUM(ZZ5_QTDVID) BETWEEN ZZ2_VIDAIN AND ZZ2_VIDAFI
				)
				OR //-- Campanha de Percentual de Vidas
				//--(ZZ2_TIPO = 'P' AND ZZ5_QTDVID BETWEEN ZZ2_VIDAIN AND ZZ2_VIDAFI) OR
				//-- Campanha de Valor
				(
					ZZ2_TIPO = 'V'
					AND SUM(ZZ5_VALORM) BETWEEN ZZ2_METAIN AND ZZ2_METAFI
				)
			)
	EndSql
